PARROT_DIR=<PARROT_DIR>

SOURCES=HTML/Template.pm CGI.pm Text/Markup/Wiki/Minimal.pm \
        Text/Markup/Wiki/MediaWiki.pm November.pm Test.pm \
        November/Storage.pm November/Storage/File.pm Tags.pm \
		Impatience.pm URI.pm URI/Grammar.pm Dispatcher.pm \
		Dispatcher/Rule.pm Session.pm

PIRS=$(SOURCES:.pm=.pir)

all: $(PIRS)

%.pir: %.pm
	$(PARROT_DIR)/parrot $(PARROT_DIR)/languages/perl6/perl6.pbc --target=pir $<  > $@

clean:
	rm $(PIRS)

tests:
	@for i in t/*.t; do echo $$i; perl6 $$i; done;
	@for i in t/tags/*.t; do echo $$i; perl6 $$i; done;
	@for i in t/storage/*.t; do echo $$i; perl6 $$i; done;
	@for i in t/markup/minimal/*.t; do echo $$i; perl6 $$i; done;
#	@for i in t/markup/mediawiki/*.t; do echo $$i; perl6 $$i; done;
	@for i in t/uri/*.t; do echo $$i; perl6 $$i; done;
	@for i in t/dispatcher/*.t; do echo $$i; perl6 $$i; done;
